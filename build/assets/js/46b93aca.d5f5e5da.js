"use strict";(self.webpackChunkhackathon_book=self.webpackChunkhackathon_book||[]).push([[3286],{2428:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"chapter-3-isaac-ai-brain/nav2-humanoid-integration","title":"Nav2 Integration for Humanoid Robots","description":"Nav2 navigation adapts to bipedal locomotion through custom costmaps and 3D obstacle representation via Isaac ROS nvblox integration.","source":"@site/docs/chapter-3-isaac-ai-brain/04-nav2-humanoid-integration.md","sourceDirName":"chapter-3-isaac-ai-brain","slug":"/chapter-3-isaac-ai-brain/nav2-humanoid-integration","permalink":"/physical-ai-and-humanoid-robotics/docs/chapter-3-isaac-ai-brain/nav2-humanoid-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/gurupak/physical-ai-and-humanoid-robotics/tree/main/docs/chapter-3-isaac-ai-brain/04-nav2-humanoid-integration.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"VSLAM Accuracy Measurement and Validation","permalink":"/physical-ai-and-humanoid-robotics/docs/chapter-3-isaac-ai-brain/vslam-accuracy-measurement"},"next":{"title":"Nav2 Configuration for Humanoid Bipedal Movement","permalink":"/physical-ai-and-humanoid-robotics/docs/chapter-3-isaac-ai-brain/nav2-humanoid-configuration"}}');var r=t(4848),a=t(8453);const s={},o="Nav2 Integration for Humanoid Robots",c={},l=[{value:"System Architecture",id:"system-architecture",level:2},{value:"3D Costmap Configuration",id:"3d-costmap-configuration",level:2},{value:"Humanoid Constraints",id:"humanoid-constraints",level:2},{value:"Launch Configuration",id:"launch-configuration",level:2},{value:"Integration Code",id:"integration-code",level:2},{value:"Performance Metrics",id:"performance-metrics",level:2},{value:"Dynamic Balancing",id:"dynamic-balancing",level:2},{value:"3D Mapping Integration",id:"3d-mapping-integration",level:2},{value:"Troubleshooting Common Issues",id:"troubleshooting-common-issues",level:2},{value:"Emergency Protocols",id:"emergency-protocols",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",mermaid:"mermaid",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"nav2-integration-for-humanoid-robots",children:"Nav2 Integration for Humanoid Robots"})}),"\n",(0,r.jsx)(n.p,{children:"Nav2 navigation adapts to bipedal locomotion through custom costmaps and 3D obstacle representation via Isaac ROS nvblox integration."}),"\n",(0,r.jsx)(n.h2,{id:"system-architecture",children:"System Architecture"}),"\n",(0,r.jsx)(n.mermaid,{value:"graph TD\r\n    A[Visual SLAM] --\x3e|Position| B[Nav2 Controller]\r\n    B --\x3e|2.5m Path| C[Footstep Planner]\r\n    C --\x3e|0.3m Steps| D[Gait Generator]\r\n    D --\x3e|Torque Commands| E[Joint Controller]\r\n\r\n    F[3D Camera] --\x3e|Point Cloud| G[nvblox Costmap]\r\n    G --\x3e|Obstacles| B\r\n    G --\x3e|Height Map| D"}),"\n",(0,r.jsx)(n.h2,{id:"3d-costmap-configuration",children:"3D Costmap Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# nav2_humanoid_params.yaml\r\nlocal_costmap:\r\n  nvblox_layer:\r\n    plugin: "nvblox::nav2::NvbloxCostmapLayer"\r\n    enabled: true\r\n    weight: 10.0\r\n    map_slice_topic: "/nvblox_node/static_map_slice"\r\n    min_height: -0.5  # meters\r\n    max_height: 2.0   # meters\r\n    obstacle_threshold: 2  # cells\r\n\r\n  footstep_layer:\r\n    plugin: "footstep_navigation::FootstepLayer"\r\n    step_size_max: 0.35\r\n    step_size_min: 0.15\r\n    footprint_padding: 0.05\r\n    stability_points: [[0.1, 0.05], [-0.1, 0.05], [0, -0.15]]\n'})}),"\n",(0,r.jsx)(n.h2,{id:"humanoid-constraints",children:"Humanoid Constraints"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Value"}),(0,r.jsx)(n.th,{children:"Unit"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Max step length"}),(0,r.jsx)(n.td,{children:"0.35"}),(0,r.jsx)(n.td,{children:"meters"}),(0,r.jsx)(n.td,{children:"Single step forward"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Max step width"}),(0,r.jsx)(n.td,{children:"0.25"}),(0,r.jsx)(n.td,{children:"meters"}),(0,r.jsx)(n.td,{children:"Lateral movement"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Max step height"}),(0,r.jsx)(n.td,{children:"0.18"}),(0,r.jsx)(n.td,{children:"meters"}),(0,r.jsx)(n.td,{children:"Stair climbing"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Step duration"}),(0,r.jsx)(n.td,{children:"0.8-1.2"}),(0,r.jsx)(n.td,{children:"seconds"}),(0,r.jsx)(n.td,{children:"Gait cycle time"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Ground clearance"}),(0,r.jsx)(n.td,{children:"0.05"}),(0,r.jsx)(n.td,{children:"meters"}),(0,r.jsx)(n.td,{children:"Foot clearance"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ZMP margin"}),(0,r.jsx)(n.td,{children:"\xb10.02"}),(0,r.jsx)(n.td,{children:"meters"}),(0,r.jsx)(n.td,{children:"Stability bounds"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"launch-configuration",children:"Launch Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Launch Nav2 with visual localization\r\nros2 launch humanoid_nav2 navigation.launch.py\r\n    use_sim_time:=true\r\n    enable_visual_localization:=true\r\n    enable_nvblox:=true\r\n    footprint: "[[0.4, 0.3], [0.4, -0.3], [-0.4, -0.3], [-0.4, 0.3]]"\r\n    robot_base_frame: "base_link"\r\n    odom_frame: "odom"\r\n    map_frame: "map"\r\n    planner_frequency: 1.0\r\n    controller_frequency: 20.0\n'})}),"\n",(0,r.jsx)(n.h2,{id:"integration-code",children:"Integration Code"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'// Humanoid footstep planner\r\nclass HumanoidFootstepPlanner : public nav2_core::Controller\r\n{\r\npublic:\r\n    geometry_msgs::TwistStamped computeVelocityCommands(\r\n        const geometry_msgs::PoseStamped& pose,\r\n        const geometry_msgs::Twist& velocity)\r\n    {\r\n        // Convert 2D path to footstep sequence\r\n        std::vector<geometry_msgs::PoseStamped> footsteps;\r\n        path_to_footsteps(pose, global_path_, footsteps);\r\n\r\n        // Check stability using ZMP criterion\r\n        bool stable = check_zmp_stability(footsteps.front());\r\n\r\n        if (!stable) {\r\n            // Execute recovery step\r\n            return calculate_recovery_step();\r\n        }\r\n\r\n        return calculate_walking_velocity(footsteps);\r\n    }\r\n\r\nprivate:\r\n    double max_step_length_ = 0.35;\r\n    double min_step_duration_ = 0.8;\r\n    std::string gait_type_ = "dynamic_walking";\r\n};\n'})}),"\n",(0,r.jsx)(n.h2,{id:"performance-metrics",children:"Performance Metrics"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Scenario"}),(0,r.jsx)(n.th,{children:"Success Rate"}),(0,r.jsx)(n.th,{children:"Planning Time"}),(0,r.jsx)(n.th,{children:"Step Accuracy"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Flat floor (5m)"}),(0,r.jsx)(n.td,{children:"95%"}),(0,r.jsx)(n.td,{children:"0.3s"}),(0,r.jsx)(n.td,{children:"\xb12cm"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Obstacle avoidance"}),(0,r.jsx)(n.td,{children:"92%"}),(0,r.jsx)(n.td,{children:"0.5s"}),(0,r.jsx)(n.td,{children:"\xb13cm"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Door navigation"}),(0,r.jsx)(n.td,{children:"88%"}),(0,r.jsx)(n.td,{children:"0.8s"}),(0,r.jsx)(n.td,{children:"\xb14cm"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Corridor (1m width)"}),(0,r.jsx)(n.td,{children:"90%"}),(0,r.jsx)(n.td,{children:"0.4s"}),(0,r.jsx)(n.td,{children:"\xb12.5cm"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"dynamic-balancing",children:"Dynamic Balancing"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# ROS 2 Python interface\r\nimport rclpy\r\nfrom geometry_msgs.msg import PointStamped\r\nfrom humanoid_msgs.msg import FootstepArray\r\n\r\nclass HumanoidNav2Interface(Node):\r\n    def __init__(self):\r\n        super().__init__('humanoid_nav2')\r\n\r\n        # Footstep publisher for visualization\r\n        self.footstep_pub = self.create_publisher(\r\n            FootstepArray, '/humanoid/footsteps', 10)\r\n\r\n        # ZMP monitor\r\n        self.zmp_sub = self.create_subscription(\r\n            PointStamped, '/humanoid/zmp', self.zmp_callback, 10)\r\n\r\n    def zmp_callback(self, zmp_msg):\r\n        # Check if ZMP is within stable region\r\n        stability_margin = 0.02  # 2cm acceptable deviation\r\n\r\n        if abs(zmp_msg.point.x) > stability_margin:\r\n            self.execute_balance_correction(zmp_msg)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"3d-mapping-integration",children:"3D Mapping Integration"}),"\n",(0,r.jsx)(n.p,{children:"The nvblox module generates real-time 3D occupancy maps from stereo cameras:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Launch nvblox with Nav2 integration\r\nros2 launch nvblox_nav2 nvblox_nav2.launch.py\r\n    mode:=static_map_slice\r\n    slice_height:=0.15\r\n    slice_variance_threshold:=0.1\r\n    mesh_publisher:=true\r\n    esdf_publisher:=true\r\n    map_clearance_radius:=1.0\n"})}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting-common-issues",children:"Troubleshooting Common Issues"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Issue"}),(0,r.jsx)(n.th,{children:"Symptom"}),(0,r.jsx)(n.th,{children:"Solution"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Step too long"}),(0,r.jsx)(n.td,{children:"Robot leans forward"}),(0,r.jsxs)(n.td,{children:["Reduce ",(0,r.jsx)(n.code,{children:"step_size_max"})," to 0.3m"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ZMP oscillation"}),(0,r.jsx)(n.td,{children:"Unstable walking"}),(0,r.jsxs)(n.td,{children:["Increase ",(0,r.jsx)(n.code,{children:"stability_margin"})," to 0.03m"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Narrow passage failure"}),(0,r.jsx)(n.td,{children:"Planner timeout"}),(0,r.jsxs)(n.td,{children:["Reduce ",(0,r.jsx)(n.code,{children:"footprint_padding"})," to 0.02m"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Height clearance"}),(0,r.jsx)(n.td,{children:"Head collision"}),(0,r.jsxs)(n.td,{children:["Adjust ",(0,r.jsx)(n.code,{children:"max_height"})," in costmap layer"]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"emergency-protocols",children:"Emergency Protocols"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"// Fall detection and recovery\r\nvoid emergency_stop()\r\n{\r\n    // Disable motion\r\n    cmd_vel_.linear.x = 0.0;\r\n    cmd_vel_.angular.z = 0.0;\r\n\r\n    // Activate stabilization\r\n    enable_emergency_stabilization();\r\n\r\n    // Save current pose for recovery\r\n    last_stable_pose_ = current_pose_;\r\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"The system achieves 95% collision-free navigation on flat surfaces with humanoid-specific gait parameters. Integration with visual SLAM provides \xb15cm positioning accuracy for precise step execution. Multi-level costmaps handle complex 3D environments including stairs and platform edges."}),"\n",(0,r.jsx)(n.p,{children:"Footstep planning operates at 2Hz to generate stable sequences, while trajectory tracking runs at 20Hz for smooth execution. The architecture supports both static and dynamic obstacles with 300ms mean replanning time. Balance control maintains ZMP within stability margins during various walking speeds from 0.1 to 1.0 m/s."}),"\n",(0,r.jsx)(n.p,{children:"Real-time 3D reconstruction via nvblox enables obstacle detection at 5Hz with 5cm voxel resolution. The costmap layers integrate semantic understanding for object-aware navigation, distinguishing between static features and dynamic entities requiring immediate response."}),"\n",(0,r.jsx)(n.p,{children:"Emergency protocols activate when tilt angles exceed 15\xb0 or foot contact forces indicate instability. The system transitions to stable standing within 500ms and can recover from minor disturbances through coordinated joint movements."}),"\n",(0,r.jsx)(n.p,{children:"Configuration files support real-time parameter adjustment for different walking styles including energy-efficient gait, fast locomotion, and precise positioning modes. The modular design allows integration with various humanoid platforms through standardized ROS 2 interfaces."}),"\n",(0,r.jsx)(n.p,{children:"Overall, the humanoid Nav2 integration provides a comprehensive navigation solution specifically designed for bipedal locomotion challenges, combining visual localization, 3D perception, and dynamic balance control within the familiar ROS 2 navigation framework. The system represents the state-of-the-art in humanoid robot autonomous navigation, delivering reliable performance across diverse indoor environments while maintaining computational efficiency suitable for embedded deployment on Jetson platforms. Through systematic integration of multiple sensor modalities and specialized algorithms, the platform achieves the unprecedented combination of navigation accuracy, stability preservation, and real-time performance required for practical humanoid robot applications."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:"End of Chapter"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>o});var i=t(6540);const r={},a=i.createContext(r);function s(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);