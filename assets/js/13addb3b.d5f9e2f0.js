"use strict";(self.webpackChunkhackathon_book=self.webpackChunkhackathon_book||[]).push([[6417],{2571:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"ros2-fundamentals/04-topics-messages","title":"Topics & Messages","description":"In the previous sub-chapter, you created a publisher node. But how do other nodes receive those messages? And what if you need to send more than just strings? This sub-chapter dives deep into topics and messages\u2014the backbone of asynchronous communication in ROS 2.","source":"@site/docs/ros2-fundamentals/04-topics-messages.md","sourceDirName":"ros2-fundamentals","slug":"/ros2-fundamentals/04-topics-messages","permalink":"/physical-ai-and-humanoid-robotics/docs/ros2-fundamentals/04-topics-messages","draft":false,"unlisted":false,"editUrl":"https://github.com/gurupak/physical-ai-and-humanoid-robotics/tree/main/docs/ros2-fundamentals/04-topics-messages.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"04-topics-messages","title":"Topics & Messages","sidebar_label":"Topics & Messages","sidebar_position":4,"sidebar_custom_props":{"difficulty":"Beginner","readingTime":"25 minutes","handsOnTime":"60 minutes"}},"sidebar":"tutorialSidebar","previous":{"title":"First Node","permalink":"/physical-ai-and-humanoid-robotics/docs/ros2-fundamentals/03-first-node"},"next":{"title":"Services","permalink":"/physical-ai-and-humanoid-robotics/docs/ros2-fundamentals/05-services"}}');var r=n(4848),t=n(8453),a=n(6850),l=n(4469);const o={id:"04-topics-messages",title:"Topics & Messages",sidebar_label:"Topics & Messages",sidebar_position:4,sidebar_custom_props:{difficulty:"Beginner",readingTime:"25 minutes",handsOnTime:"60 minutes"}},c="Topics & Messages",d={},h=[{value:"Understanding the Publish-Subscribe Pattern",id:"understanding-the-publish-subscribe-pattern",level:2},{value:"Benefits of Pub-Sub",id:"benefits-of-pub-sub",level:3},{value:"ROS 2 Message Types",id:"ros-2-message-types",level:2},{value:"Common Message Packages",id:"common-message-packages",level:3},{value:"Message Anatomy",id:"message-anatomy",level:3},{value:"Creating a Subscriber Node",id:"creating-a-subscriber-node",level:2},{value:"Write the Subscriber Code",id:"write-the-subscriber-code",level:3},{value:"Update setup.py",id:"update-setuppy",level:3},{value:"Build and Run",id:"build-and-run",level:3},{value:"Topic Inspection with CLI Tools",id:"topic-inspection-with-cli-tools",level:2},{value:"List Active Topics",id:"list-active-topics",level:3},{value:"Get Topic Info",id:"get-topic-info",level:3},{value:"Echo Topic Messages",id:"echo-topic-messages",level:3},{value:"Publish from Command Line",id:"publish-from-command-line",level:3},{value:"Working with Complex Messages",id:"working-with-complex-messages",level:2},{value:"Velocity Publisher Example",id:"velocity-publisher-example",level:3},{value:"Quality of Service (QoS)",id:"quality-of-service-qos",level:2},{value:"Why QoS Matters",id:"why-qos-matters",level:3},{value:"QoS Profiles",id:"qos-profiles",level:3},{value:"Common Patterns and Pitfalls",id:"common-patterns-and-pitfalls",level:2},{value:"Pattern: Throttling Messages",id:"pattern-throttling-messages",level:3},{value:"Pitfall: Mismatched Message Types",id:"pitfall-mismatched-message-types",level:3},{value:"Pitfall: Forgetting to Spin",id:"pitfall-forgetting-to-spin",level:3},{value:"What You&#39;ve Learned",id:"what-youve-learned",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"Additional Resources",id:"additional-resources",level:2}];function u(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"topics--messages",children:"Topics & Messages"})}),"\n",(0,r.jsx)(s.p,{children:"In the previous sub-chapter, you created a publisher node. But how do other nodes receive those messages? And what if you need to send more than just strings? This sub-chapter dives deep into topics and messages\u2014the backbone of asynchronous communication in ROS 2."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"understanding-the-publish-subscribe-pattern",children:"Understanding the Publish-Subscribe Pattern"}),"\n",(0,r.jsx)(s.p,{children:"Imagine a radio station broadcasting music. The station (publisher) sends signals without knowing who's listening. Anyone with a radio (subscriber) tuned to the right frequency (topic) receives the broadcast. If no one is listening, the music still plays\u2014it's just not heard."}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"This is the publish-subscribe pattern"})," in ROS 2:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Publishers"})," send messages to topics without knowing (or caring) about subscribers"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Subscribers"})," listen to topics and receive all messages published there"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Topics"})," are named channels that decouple publishers from subscribers"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"benefits-of-pub-sub",children:"Benefits of Pub-Sub"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Decoupling"}),": Publishers and subscribers don't need to know about each other"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Scalability"}),": Add/remove subscribers without modifying publishers"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Flexibility"}),": Multiple publishers and subscribers on the same topic"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Asynchronous"}),": No blocking\u2014publishers don't wait for subscribers"]}),"\n"]}),"\n",(0,r.jsx)(s.mermaid,{value:"graph LR\n    A[Camera Publisher] --\x3e|Image Messages| B[Topic: /camera/image]\n    B --\x3e|Image Messages| C[Object Detector Subscriber]\n    B --\x3e|Image Messages| D[Image Display Subscriber]\n    B --\x3e|Image Messages| E[Image Recorder Subscriber]\n    \n    style A fill:#E3F2FD\n    style B fill:#FFF3E0\n    style C fill:#E8F5E9\n    style D fill:#E8F5E9\n    style E fill:#E8F5E9"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Diagram Explanation"}),": A single camera publisher sends images to a topic. Three different subscribers (detector, display, recorder) all receive the same images independently."]}),"\n",(0,r.jsx)(a.A,{question:"What happens if a publisher sends a message when no subscribers are listening?",options:["The message is queued until a subscriber connects","The message is immediately discarded","The publisher blocks until a subscriber connects","An error is logged and the node crashes"],correctAnswer:1,explanation:"ROS 2 uses a fire-and-forget model for topics. If no subscribers exist, messages are discarded immediately to prevent unbounded memory growth. This is intentional\u2014publishers don't wait for subscribers.",difficulty:"medium"}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"ros-2-message-types",children:"ROS 2 Message Types"}),"\n",(0,r.jsx)(s.p,{children:"Messages are strongly-typed data structures. ROS 2 provides hundreds of standard message types organized into packages:"}),"\n",(0,r.jsx)(s.h3,{id:"common-message-packages",children:"Common Message Packages"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"std_msgs"}),": Basic types"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from std_msgs.msg import String, Int32, Float64, Bool\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"geometry_msgs"}),": Spatial data"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from geometry_msgs.msg import Point, Pose, Twist, Vector3\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"sensor_msgs"}),": Sensor data"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from sensor_msgs.msg import Image, LaserScan, Imu, PointCloud2\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"nav_msgs"}),": Navigation data"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from nav_msgs.msg import Odometry, Path\n"})}),"\n",(0,r.jsx)(s.h3,{id:"message-anatomy",children:"Message Anatomy"}),"\n",(0,r.jsxs)(s.p,{children:["Every message type has ",(0,r.jsx)(s.strong,{children:"fields"})," with specific data types:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"# geometry_msgs/Twist\nlinear:\n  x: float64  # Forward/backward velocity (m/s)\n  y: float64  # Left/right velocity (m/s)\n  z: float64  # Up/down velocity (m/s)\nangular:\n  x: float64  # Roll rate (rad/s)\n  y: float64  # Pitch rate (rad/s)\n  z: float64  # Yaw rate (rad/s)\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"creating-a-subscriber-node",children:"Creating a Subscriber Node"}),"\n",(0,r.jsx)(s.p,{children:"Let's create a subscriber that listens to the messages from our publisher in Sub-Chapter 3."}),"\n",(0,r.jsx)(s.h3,{id:"write-the-subscriber-code",children:"Write the Subscriber Code"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",metastring:'title="my_first_package/subscriber_node.py" showLineNumbers {9-10,13-17}',children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalSubscriber(Node):\n    def __init__(self):\n        super().__init__('minimal_subscriber')\n        \n        # Create subscriber: message type, topic name, callback, queue size\n        self.subscription = self.create_subscription(\n            String, 'chatter', self.listener_callback, 10)\n        \n        self.get_logger().info('Subscriber node started')\n    \n    def listener_callback(self, msg):\n        # This function is called every time a message is received\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MinimalSubscriber()\n    \n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Key Points"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Line 10"}),": Create subscription with message type, topic name, callback function, and queue size"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Lines 15-17"}),": Callback function executes whenever a message arrives"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Callback Parameter"}),": ",(0,r.jsx)(s.code,{children:"msg"})," is a ",(0,r.jsx)(s.code,{children:"String"})," object with a ",(0,r.jsx)(s.code,{children:".data"})," attribute"]}),"\n"]}),"\n",(0,r.jsx)(l.A,{type:"tip",title:"Callback Execution",children:(0,r.jsx)(s.p,{children:"The callback function runs in the executor's thread. Keep callbacks fast\u2014heavy computation should be offloaded to separate threads or use timers to batch process messages."})}),"\n",(0,r.jsx)(s.h3,{id:"update-setuppy",children:"Update setup.py"}),"\n",(0,r.jsx)(s.p,{children:"Add the subscriber entry point:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",metastring:'title="setup.py" {22-23}',children:"entry_points={\n    'console_scripts': [\n        'publisher = my_first_package.publisher_node:main',\n        'subscriber = my_first_package.subscriber_node:main',\n    ],\n},\n"})}),"\n",(0,r.jsx)(s.h3,{id:"build-and-run",children:"Build and Run"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select my_first_package\nsource ~/ros2_ws/install/setup.bash\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Run publisher in Terminal 1"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 run my_first_package publisher\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Run subscriber in Terminal 2"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"source ~/ros2_ws/install/setup.bash\nros2 run my_first_package subscriber\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Expected Output (Terminal 2)"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'[INFO] [minimal_subscriber]: Subscriber node started\n[INFO] [minimal_subscriber]: I heard: "Hello World: 5"\n[INFO] [minimal_subscriber]: I heard: "Hello World: 6"\n[INFO] [minimal_subscriber]: I heard: "Hello World: 7"\n...\n'})}),"\n",(0,r.jsxs)(s.p,{children:["\ud83c\udf89 ",(0,r.jsx)(s.strong,{children:"Success!"})," Your subscriber is receiving messages from the publisher."]}),"\n",(0,r.jsx)(a.A,{question:"In `self.create_subscription(String, 'chatter', self.listener_callback, 10)`, what is the purpose of `self.listener_callback`?",options:["It's the name of the subscriber node","It's the function called every time a message is received on the topic","It's the queue size for buffering messages","It's the message type being subscribed to"],correctAnswer:1,explanation:"The callback function (self.listener_callback) is invoked by the ROS 2 executor every time a new message arrives on the subscribed topic. It receives the message as a parameter.",difficulty:"easy"}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"topic-inspection-with-cli-tools",children:"Topic Inspection with CLI Tools"}),"\n",(0,r.jsx)(s.p,{children:"ROS 2 provides powerful command-line tools to inspect topics:"}),"\n",(0,r.jsx)(s.h3,{id:"list-active-topics",children:"List Active Topics"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 topic list\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Output"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"/chatter\n/parameter_events\n/rosout\n"})}),"\n",(0,r.jsx)(s.h3,{id:"get-topic-info",children:"Get Topic Info"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 topic info /chatter\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Output"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"Type: std_msgs/msg/String\nPublisher count: 1\nSubscription count: 1\n"})}),"\n",(0,r.jsx)(s.h3,{id:"echo-topic-messages",children:"Echo Topic Messages"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 topic echo /chatter\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Output"})," (live stream):"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"data: 'Hello World: 12'\n---\ndata: 'Hello World: 13'\n---\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Press ",(0,r.jsx)(s.code,{children:"Ctrl+C"})," to stop."]}),"\n",(0,r.jsx)(s.h3,{id:"publish-from-command-line",children:"Publish from Command Line"}),"\n",(0,r.jsx)(s.p,{children:"You can publish manually without writing code:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 topic pub /chatter std_msgs/msg/String \"data: 'Hello from CLI'\"\n"})}),"\n",(0,r.jsxs)(s.p,{children:["This publishes a single message (add ",(0,r.jsx)(s.code,{children:"--rate 1"})," to publish at 1 Hz)."]}),"\n",(0,r.jsx)(l.A,{type:"info",title:"CLI Publishing for Testing",children:(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"ros2 topic pub"})," is incredibly useful for testing subscribers without writing publisher code. Great for debugging!"]})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"working-with-complex-messages",children:"Working with Complex Messages"}),"\n",(0,r.jsxs)(s.p,{children:["Let's upgrade from simple strings to robot velocity commands using ",(0,r.jsx)(s.code,{children:"geometry_msgs/Twist"}),"."]}),"\n",(0,r.jsx)(s.h3,{id:"velocity-publisher-example",children:"Velocity Publisher Example"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",metastring:'title="my_first_package/velocity_publisher.py" showLineNumbers {2,10-17}',children:"import rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import Twist\n\nclass VelocityPublisher(Node):\n    def __init__(self):\n        super().__init__('velocity_publisher')\n        self.publisher_ = self.create_publisher(Twist, '/cmd_vel', 10)\n        self.timer = self.create_timer(0.5, self.publish_velocity)\n        \n    def publish_velocity(self):\n        msg = Twist()\n        # Set linear velocity (forward/backward)\n        msg.linear.x = 0.5  # 0.5 m/s forward\n        msg.linear.y = 0.0\n        msg.linear.z = 0.0\n        # Set angular velocity (rotation)\n        msg.angular.x = 0.0\n        msg.angular.y = 0.0\n        msg.angular.z = 0.2  # 0.2 rad/s counterclockwise\n        \n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: linear.x={msg.linear.x}, angular.z={msg.angular.z}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = VelocityPublisher()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"What This Does"}),": Commands a robot to move forward at 0.5 m/s while rotating counterclockwise at 0.2 rad/s."]}),"\n",(0,r.jsx)(a.A,{question:"What would happen if you set `msg.linear.x = -1.0` in the Twist message?",options:["The robot would stop moving","The robot would move backward at 1.0 m/s","The robot would move upward","An error would be thrown\u2014negative values aren't allowed"],correctAnswer:1,explanation:"In geometry_msgs/Twist, positive linear.x means forward, negative means backward. Setting linear.x = -1.0 commands the robot to move backward at 1 m/s. Negative values are perfectly valid.",difficulty:"medium"}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"quality-of-service-qos",children:"Quality of Service (QoS)"}),"\n",(0,r.jsxs)(s.p,{children:["ROS 2 topics support ",(0,r.jsx)(s.strong,{children:"Quality of Service (QoS) policies"})," that control message delivery behavior."]}),"\n",(0,r.jsx)(s.h3,{id:"why-qos-matters",children:"Why QoS Matters"}),"\n",(0,r.jsx)(s.p,{children:"Different use cases need different reliability/performance trade-offs:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Sensor data"})," (camera, lidar): High frequency, loss acceptable \u2192 ",(0,r.jsx)(s.strong,{children:"Best Effort"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Commands"})," (motor control): Must arrive \u2192 ",(0,r.jsx)(s.strong,{children:"Reliable"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Diagnostics"}),": Need history of recent messages \u2192 ",(0,r.jsx)(s.strong,{children:"Keep Last N"})]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"qos-profiles",children:"QoS Profiles"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy\n\n# Sensor data profile (lossy, low latency)\nsensor_qos = QoSProfile(\n    reliability=ReliabilityPolicy.BEST_EFFORT,\n    history=HistoryPolicy.KEEP_LAST,\n    depth=10\n)\n\npublisher = self.create_publisher(Image, '/camera/image', sensor_qos)\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Common Policies"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Reliability"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"BEST_EFFORT"}),": Send and forget (fast, may lose messages)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"RELIABLE"}),": Guarantee delivery (slower, no loss)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"History"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"KEEP_LAST"}),": Store last N messages (depth parameter)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"KEEP_ALL"}),": Store all messages (unbounded)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(l.A,{type:"warning",title:"QoS Compatibility",children:(0,r.jsxs)(s.p,{children:["Publishers and subscribers must have ",(0,r.jsx)(s.strong,{children:"compatible"})," QoS settings to communicate. For example, a ",(0,r.jsx)(s.code,{children:"BEST_EFFORT"})," publisher can't send to a ",(0,r.jsx)(s.code,{children:"RELIABLE"})," subscriber. Use ",(0,r.jsx)(s.code,{children:"ros2 topic info -v <topic>"})," to check QoS settings."]})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"common-patterns-and-pitfalls",children:"Common Patterns and Pitfalls"}),"\n",(0,r.jsx)(s.h3,{id:"pattern-throttling-messages",children:"Pattern: Throttling Messages"}),"\n",(0,r.jsx)(s.p,{children:"If you're receiving messages faster than you can process:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"import time\n\nclass ThrottledSubscriber(Node):\n    def __init__(self):\n        super().__init__('throttled_subscriber')\n        self.subscription = self.create_subscription(\n            Image, '/camera/image', self.image_callback, 10)\n        self.last_process_time = time.time()\n        \n    def image_callback(self, msg):\n        current_time = time.time()\n        # Only process every 0.5 seconds\n        if current_time - self.last_process_time > 0.5:\n            self.process_image(msg)\n            self.last_process_time = current_time\n    \n    def process_image(self, msg):\n        # Heavy computation here\n        pass\n"})}),"\n",(0,r.jsx)(s.h3,{id:"pitfall-mismatched-message-types",children:"Pitfall: Mismatched Message Types"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Error"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"# Publisher sends String\nself.pub = self.create_publisher(String, '/data', 10)\n\n# Subscriber expects Int32 on same topic\nself.sub = self.create_subscription(Int32, '/data', self.callback, 10)\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Result"}),": No communication! Publisher and subscriber must use the ",(0,r.jsx)(s.strong,{children:"same message type"})," on a topic."]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Fix"}),": Ensure both use ",(0,r.jsx)(s.code,{children:"String"})," or both use ",(0,r.jsx)(s.code,{children:"Int32"}),"."]}),"\n",(0,r.jsx)(s.h3,{id:"pitfall-forgetting-to-spin",children:"Pitfall: Forgetting to Spin"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"def main(args=None):\n    rclpy.init(args=args)\n    node = MinimalSubscriber()\n    # Missing rclpy.spin(node)  \u2190 Callbacks never execute!\n    node.destroy_node()\n    rclpy.shutdown()\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Fix"}),": Always call ",(0,r.jsx)(s.code,{children:"rclpy.spin()"})," to process callbacks."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"what-youve-learned",children:"What You've Learned"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\u2705 The ",(0,r.jsx)(s.strong,{children:"publish-subscribe pattern"})," decouples publishers and subscribers via topics"]}),"\n",(0,r.jsxs)(s.li,{children:["\u2705 ",(0,r.jsx)(s.strong,{children:"Messages"})," are strongly-typed data structures (String, Twist, Image, etc.)"]}),"\n",(0,r.jsxs)(s.li,{children:["\u2705 ",(0,r.jsx)(s.strong,{children:"Subscribers"})," use callbacks to process incoming messages"]}),"\n",(0,r.jsxs)(s.li,{children:["\u2705 ",(0,r.jsx)(s.strong,{children:"ros2 CLI tools"})," (topic list, echo, pub) for inspection and testing"]}),"\n",(0,r.jsxs)(s.li,{children:["\u2705 ",(0,r.jsx)(s.strong,{children:"QoS policies"})," control reliability, history, and performance trade-offs"]}),"\n",(0,r.jsx)(s.li,{children:"\u2705 Common patterns (throttling) and pitfalls (type mismatches, missing spin)"}),"\n"]}),"\n",(0,r.jsx)(a.A,{question:"Which QoS reliability policy should you use for high-frequency sensor data where occasional message loss is acceptable?",options:["RELIABLE\u2014to ensure all sensor data arrives","BEST_EFFORT\u2014to minimize latency and allow message loss","KEEP_ALL\u2014to buffer all messages","TRANSIENT_LOCAL\u2014to persist messages"],correctAnswer:1,explanation:"For high-frequency sensor data (camera, lidar), BEST_EFFORT is preferred because it minimizes latency and avoids retransmission overhead. Occasional message loss is acceptable since new data arrives quickly.",difficulty:"hard"}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(s.p,{children:["Now that you've mastered asynchronous communication with topics, let's explore ",(0,r.jsx)(s.strong,{children:"synchronous"})," communication with services!"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Continue to"}),": ",(0,r.jsx)(s.a,{href:"05-services",children:"Services"})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,r.jsx)(s.admonition,{title:"Dive Deeper",type:"info",children:(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Py-Publisher-And-Subscriber.html",children:"ROS 2 Topic Tutorial"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.ros2.org/humble/api/",children:"Message Type Reference"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.ros.org/en/humble/Concepts/About-Quality-of-Service-Settings.html",children:"QoS Policies Guide"})}),"\n"]})})]})}function p(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},4469:(e,s,n)=>{n.d(s,{A:()=>a});n(6540);const i={callout:"callout_jYHE",calloutHeader:"calloutHeader_LAHO",calloutIcon:"calloutIcon_Sver",calloutTitle:"calloutTitle_Y2EA",calloutContent:"calloutContent_fpOd",note:"note_VCic",tip:"tip_s2nh",warning:"warning_eW1i",danger:"danger_zfsw",info:"info_IOty"};var r=n(4848),t={note:"\ud83d\udcdd",tip:"\ud83d\udca1",warning:"\u26a0\ufe0f",danger:"\ud83d\udea8",info:"\u2139\ufe0f"};const a=function(e){var s=e.type,n=void 0===s?"note":s,a=e.title,l=e.icon,o=e.children,c=l||t[n];return(0,r.jsxs)("div",{className:i.callout+" "+i[n],role:"note","aria-label":n+" callout",children:[(0,r.jsxs)("div",{className:i.calloutHeader,children:[(0,r.jsx)("span",{className:i.calloutIcon,children:c}),a&&(0,r.jsx)("strong",{className:i.calloutTitle,children:a})]}),(0,r.jsx)("div",{className:i.calloutContent,children:o})]})}},6850:(e,s,n)=>{n.d(s,{A:()=>a});var i=n(6540);const r={quizContainer:"quizContainer_Ly96",quizHeader:"quizHeader_Qo06",quizLabel:"quizLabel_MaFv",difficultyBadge:"difficultyBadge_Wo6d",easy:"easy_isbn",medium:"medium_p6MP",hard:"hard_P2Aa",question:"question_cvou",codeSnippet:"codeSnippet__bHr",options:"options_VfkM",option:"option_Jqpj",selected:"selected_wvvN",correct:"correct_o2Yu",incorrect:"incorrect_BE9l",optionLetter:"optionLetter_VWfV",optionText:"optionText_Aap0",checkmark:"checkmark_dcs6",cross:"cross_Hcmk",feedback:"feedback_Z1tN",feedbackCorrect:"feedbackCorrect_KhSC",feedbackIncorrect:"feedbackIncorrect_PbO3",feedbackHeader:"feedbackHeader__j5R",feedbackIcon:"feedbackIcon_B5j3",explanation:"explanation_VZj9",retryButton:"retryButton_OmlM"};var t=n(4848);const a=function(e){var s=e.question,n=e.options,a=e.correctAnswer,l=e.explanation,o=(e.type,e.codeSnippet),c=e.difficulty,d=void 0===c?"medium":c,h=(0,i.useState)(null),u=h[0],p=h[1],m=(0,i.useState)(!1),g=m[0],b=m[1],x=u===a;return(0,t.jsxs)("div",{className:"quiz-container "+r.quizContainer,"data-difficulty":d,children:[(0,t.jsxs)("div",{className:r.quizHeader,children:[(0,t.jsx)("span",{className:r.quizLabel,children:"Quiz"}),d&&(0,t.jsx)("span",{className:r.difficultyBadge+" "+r[d],children:d.charAt(0).toUpperCase()+d.slice(1)})]}),(0,t.jsx)("div",{className:r.question,children:s}),o&&(0,t.jsx)("pre",{className:r.codeSnippet,children:(0,t.jsx)("code",{children:o})}),(0,t.jsx)("div",{className:r.options,children:n.map(function(e,s){return(0,t.jsxs)("button",{className:r.option+" "+(u===s?r.selected:"")+" "+(g&&s===a?r.correct:g&&u===s?r.incorrect:""),onClick:function(){return function(e){g||(p(e),b(!0))}(s)},disabled:g,"aria-pressed":u===s,children:[(0,t.jsxs)("span",{className:r.optionLetter,children:[String.fromCharCode(65+s),"."]}),(0,t.jsx)("span",{className:r.optionText,children:e}),g&&s===a&&(0,t.jsx)("span",{className:r.checkmark,children:"\u2713"}),g&&u===s&&s!==a&&(0,t.jsx)("span",{className:r.cross,children:"\u2717"})]},s)})}),g&&(0,t.jsxs)("div",{className:r.feedback+" "+(x?r.feedbackCorrect:r.feedbackIncorrect),children:[(0,t.jsx)("div",{className:r.feedbackHeader,children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:r.feedbackIcon,children:"\u2713"}),(0,t.jsx)("strong",{children:"Correct!"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:r.feedbackIcon,children:"\u2717"}),(0,t.jsx)("strong",{children:"Not quite right"})]})}),(0,t.jsx)("div",{className:r.explanation,children:l}),(0,t.jsx)("button",{className:r.retryButton,onClick:function(){p(null),b(!1)},children:"Try Again"})]})]})}},8453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>l});var i=n(6540);const r={},t=i.createContext(r);function a(e){const s=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);